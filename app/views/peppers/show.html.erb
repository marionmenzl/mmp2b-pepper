<% content_for :title, "Peppers" %>
    <div class="content">
        <h1><%= @pepper.name%></h1>
        <%= content_tag :div, class: "container-tracker", data: {info: @pepper.to_json} do %>
        <% end %>

        <% if @pepper.is_a?(ToDo) %>
          <table border="1">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Done</th>
              </tr>
            </thead>

            <tbody>

              <%@tasks.each do |task| %>
                <tr>
                  <td><%= task.id %></td>
                  <td><%= task.name %></td>
                  <td><%= task.status %></td>

                  <td><%= link_to 'Edit', edit_pepper_path(@pepper) %></td>
                  <td><%= link_to 'Destroy', pepper_path(@pepper), method: :delete, data: { confirm: 'Are you sure?' } %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
          <tr><td><%= link_to 'New Task', new_pepper_task_path(@pepper) %></td></tr>
        <%end%>


        <%= button_to 'Edit this pepper', root_path, :method => :get, :class => 'btn btn-info btn-sm' %>
        <button class="btn btn-primary" data-toggle="modal" data-target="#myModal">
          Delete this pepper
        </button>

        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Delete Pepper</h4>
              </div>
              <div class="modal-body">
                Do you really want to delete this pepper (<%= @pepper.name %>)?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default btn-simple" data-dismiss="modal">Close</button>
                <%= button_to 'Delete this pepper', pepper_path(@pepper), method: :delete, :class => 'btn btn-danger btn-simple' %>
              </div>
            </div>
          </div>
        </div>

        <script>
            var data = $(".container-tracker").data("info");
            $(document).on('turbolinks:load', () => {
                setTracker("<%= @pepper.class.name %>", data);
            });
        </script>
    </div>
